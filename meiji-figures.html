<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ˜æ²»ç»´æ–°äººç‰©å¿—</title>
<script src="https://unpkg.com/vis-network@9.1.6/standalone/umd/vis-network.min.js"></script>
<style>
:root {
  --bg: #faf8f5;
  --bg2: #f0ebe4;
  --bg3: #e8e0d4;
  --text: #2c2420;
  --text2: #5a4e44;
  --accent: #8b2500;
  --accent2: #c4956a;
  --border: #d4c8b8;
  --shadow: rgba(44,36,32,0.08);
  --card: #fff;
}
[data-theme="dark"] {
  --bg: #1a1614;
  --bg2: #2a2420;
  --bg3: #3a322c;
  --text: #e8e0d4;
  --text2: #b8a898;
  --accent: #e07050;
  --accent2: #c4956a;
  --border: #4a3e34;
  --shadow: rgba(0,0,0,0.3);
  --card: #2a2420;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: "Hiragino Sans GB","Microsoft YaHei","Noto Sans SC",sans-serif; background:var(--bg); color:var(--text); line-height:1.6; transition: all .3s; }
.container { max-width:1400px; margin:0 auto; padding:20px; }
header { text-align:center; padding:40px 20px 30px; position:relative; }
header h1 { font-size:2.4em; font-weight:300; letter-spacing:.15em; color:var(--accent); }
header h1 span { font-size:.5em; display:block; color:var(--text2); letter-spacing:.3em; margin-top:4px; }
.theme-toggle { position:absolute; top:20px; right:20px; background:var(--bg2); border:1px solid var(--border); border-radius:20px; padding:6px 14px; cursor:pointer; font-size:1.1em; color:var(--text); }
nav { display:flex; justify-content:center; gap:12px; margin-bottom:30px; flex-wrap:wrap; }
nav button { background:var(--bg2); border:1px solid var(--border); border-radius:6px; padding:8px 20px; cursor:pointer; font-size:.95em; color:var(--text); transition:all .2s; }
nav button.active, nav button:hover { background:var(--accent); color:#fff; border-color:var(--accent); }
.section { display:none; }
.section.active { display:block; }
/* Timeline bar */
.timeline-wrap { overflow-x:auto; background:var(--card); border:1px solid var(--border); border-radius:8px; padding:20px; margin-bottom:30px; box-shadow:0 2px 8px var(--shadow); }
.timeline-svg { min-width:1200px; }
/* Table */
.table-controls { display:flex; gap:10px; margin-bottom:15px; flex-wrap:wrap; align-items:center; }
.table-controls input, .table-controls select { background:var(--card); border:1px solid var(--border); border-radius:6px; padding:6px 12px; color:var(--text); font-size:.9em; }
.table-controls input { flex:1; min-width:200px; }
table { width:100%; border-collapse:collapse; background:var(--card); border-radius:8px; overflow:hidden; box-shadow:0 2px 8px var(--shadow); font-size:.88em; }
th { background:var(--bg2); padding:10px 8px; text-align:left; cursor:pointer; white-space:nowrap; user-select:none; border-bottom:2px solid var(--border); }
th:hover { background:var(--bg3); }
th .sort-arrow { font-size:.7em; margin-left:4px; }
td { padding:8px; border-bottom:1px solid var(--border); vertical-align:top; }
tr:hover td { background:var(--bg2); }
.faction-tag { display:inline-block; padding:2px 8px; border-radius:10px; font-size:.8em; color:#fff; white-space:nowrap; }
/* Network */
#network { width:100%; height:700px; background:var(--card); border:1px solid var(--border); border-radius:8px; box-shadow:0 2px 8px var(--shadow); }
.legend { display:flex; flex-wrap:wrap; gap:8px; margin:15px 0; justify-content:center; }
.legend-item { display:flex; align-items:center; gap:5px; font-size:.85em; }
.legend-dot { width:14px; height:14px; border-radius:50%; }
.edge-legend { display:flex; flex-wrap:wrap; gap:12px; margin:10px 0; justify-content:center; font-size:.83em; }
.edge-legend span { display:flex; align-items:center; gap:4px; }
.edge-line { width:24px; height:3px; display:inline-block; }
@media(max-width:768px) {
  header h1 { font-size:1.6em; }
  .container { padding:10px; }
  table { font-size:.78em; }
  #network { height:500px; }
}
</style>
</head>
<body>
<header>
  <h1>æ˜æ²»ç»´æ–°äººç‰©å¿—<span>å¹•æœ«ãƒ»ç¶­æ–° ä¸‰åä¹äººã®ç¾¤åƒ</span></h1>
  <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
</header>
<div class="container">
<nav>
  <button class="active" onclick="showSection('timeline',this)">ğŸ“… ç”Ÿå’å¹´è¡¨</button>
  <button onclick="showSection('table',this)">ğŸ“‹ äººç‰©å¹´è¡¨</button>
  <button onclick="showSection('graph',this)">ğŸ•¸ äººç‰©å…³ç³»å›¾</button>
</nav>

<div id="sec-timeline" class="section active">
<h2 style="text-align:center;margin-bottom:15px;color:var(--accent)">äººç‰©ç”Ÿå’æ—¶é—´çº¿ (1800-1942)</h2>
<div class="timeline-wrap"><div id="timeline-container"></div></div>
</div>

<div id="sec-table" class="section">
<h2 style="text-align:center;margin-bottom:15px;color:var(--accent)">äººç‰©å¹´è¡¨</h2>
<div class="table-controls">
  <input type="text" id="searchBox" placeholder="ğŸ” æœç´¢äººç‰©ã€äº‹ä»¶..." oninput="filterTable()">
  <select id="factionFilter" onchange="filterTable()">
    <option value="">å…¨éƒ¨é˜µè¥</option>
    <option value="å¹•åºœæ–¹">å¹•åºœæ–¹</option>
    <option value="è¨æ‘©è—©">è¨æ‘©è—©</option>
    <option value="é•¿å·è—©">é•¿å·è—©</option>
    <option value="å€’å¹•æ´¾/å¿—å£«">å€’å¹•æ´¾/å¿—å£«</option>
    <option value="æ˜æ²»æ”¿åºœ">æ˜æ²»æ”¿åºœ</option>
    <option value="æ€æƒ³å®¶/æ–‡åŒ–">æ€æƒ³å®¶/æ–‡åŒ–</option>
    <option value="å†›äº‹">å†›äº‹</option>
    <option value="å¥³æ€§">å¥³æ€§</option>
  </select>
</div>
<div style="overflow-x:auto">
<table id="mainTable">
<thead><tr>
  <th onclick="sortTable(0)" data-col="0">åºå·<span class="sort-arrow"></span></th>
  <th onclick="sortTable(1)" data-col="1">äººç‰©<span class="sort-arrow"></span></th>
  <th onclick="sortTable(2)" data-col="2">æ—¥æ–‡å<span class="sort-arrow"></span></th>
  <th onclick="sortTable(3)" data-col="3">ç”Ÿå’å¹´<span class="sort-arrow"></span></th>
  <th onclick="sortTable(4)" data-col="4">é˜µè¥/æ´¾åˆ«<span class="sort-arrow"></span></th>
  <th>ä¸»è¦èº«ä»½/è§’è‰²</th>
  <th>å…³é”®äº‹ä»¶</th>
  <th>ç›¸å…³äººç‰©</th>
  <th>NHKå¤§æ²³å‰§</th>
</tr></thead>
<tbody id="tableBody"></tbody>
</table>
</div>
</div>

<div id="sec-graph" class="section">
<h2 style="text-align:center;margin-bottom:10px;color:var(--accent)">äººç‰©å…³ç³»å›¾</h2>
<div class="legend" id="nodeLegend"></div>
<div class="edge-legend" id="edgeLegend"></div>
<div id="network"></div>
</div>
</div>

<script>
const FCOLORS = {
  'å¹•åºœæ–¹':'#3a6ea5','è¨æ‘©è—©':'#d4781f','é•¿å·è—©':'#2e7d32','å€’å¹•æ´¾/å¿—å£«':'#c62828',
  'æ˜æ²»æ”¿åºœ':'#6a1b9a','æ€æƒ³å®¶/æ–‡åŒ–':'#00796b','å†›äº‹':'#8b1a1a','å¥³æ€§':'#c2185b'
};

const DATA = [
  {id:1,cn:'å¾·å·é½æ˜­',jp:'å¾³å·æ–‰æ˜­',b:1800,d:1860,faction:'å¹•åºœæ–¹',role:'æ°´æˆ·è—©ç¬¬9ä»£è—©ä¸»',event:'å°Šç‹æ”˜å¤·æ€æƒ³æºå¤´ï¼Œå®‰æ”¿å¤§ç‹±',related:'å¾·å·åº†å–œ(å­)ã€äº•ä¼Šç›´å¼¼(æ”¿æ•Œ)',drama:'å¾³å·æ…¶å–œ (1998)'},
  {id:2,cn:'å‰ç”°æ¾é˜´',jp:'å‰ç”°æ¾é™°',b:1830,d:1859,faction:'é•¿å·è—©',role:'æ€æƒ³å®¶ï¼Œæ¾ä¸‹æ‘å¡¾åˆ›åŠè€…',event:'å¯†èˆªæœªé‚ã€å®‰æ”¿å¤§ç‹±è¢«å¤„åˆ‘',related:'é«˜æ‰æ™‹ä½œã€ä¹…å‚ç„ç‘ã€ä¼Šè—¤åšæ–‡ã€å±±å¿æœ‰æœ‹(å¼Ÿå­)',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:3,cn:'ä½ä¹…é—´è±¡å±±',jp:'ä½ä¹…é–“è±¡å±±',b:1811,d:1864,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'å…µå­¦å®¶ï¼Œå¼€å›½è®ºå…ˆé©±',event:'æå€¡å’Œé­‚æ´‹æ‰ï¼Œè¢«æš—æ€',related:'å‰ç”°æ¾é˜´(å¼Ÿå­)ã€èƒœæµ·èˆŸ(å¼Ÿå­)',drama:'â€”'},
  {id:4,cn:'ä¸­æµœä¸‡æ¬¡éƒ',jp:'ä¸­æ¿±è¬æ¬¡éƒ',b:1827,d:1898,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'æ¼‚æµæ¸”å¤«ï¼Œç¿»è¯‘å®¶',event:'æ¼‚æµè‡³ç¾å›½ï¼Œå¸¦å›è¥¿æ–¹çŸ¥è¯†',related:'â€”',drama:'â€”'},
  {id:5,cn:'é«˜æ‰æ™‹ä½œ',jp:'é«˜æ‰æ™‹ä½œ',b:1839,d:1867,faction:'é•¿å·è—©',role:'å¥‡å…µé˜Ÿåˆ›å»ºè€…',event:'ä¸‹å…³ä¸¾å…µã€åŠŸå±±å¯ºèµ·ä¹‰',related:'å‰ç”°æ¾é˜´(å¸ˆ)ã€ä¹…å‚ç„ç‘(åŒé—¨)',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:6,cn:'ä¹…å‚ç„ç‘',jp:'ä¹…å‚ç„ç‘',b:1840,d:1864,faction:'é•¿å·è—©',role:'å°Šæ”˜æ´¾æ¿€è¿›å…ˆé”‹',event:'ç¦é—¨ä¹‹å˜æˆ˜æ­»',related:'å‰ç”°æ¾é˜´(å¸ˆ+å²³çˆ¶)ã€é«˜æ‰æ™‹ä½œ(åŒé—¨)',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:7,cn:'æ­¦å¸‚åŠå¹³å¤ª',jp:'æ­¦å¸‚åŠå¹³å¤ª',b:1829,d:1865,faction:'å€’å¹•æ´¾/å¿—å£«',role:'åœŸä½å‹¤ç‹å…šç›Ÿä¸»',event:'åœŸä½å‹¤ç‹å…šå¼¹å‹ã€åˆ‡è…¹',related:'å‚æœ¬é¾™é©¬(åŒä¹¡)ã€ä¸­å†ˆæ…å¤ªéƒ',drama:'é¾é¦¬ä¼ (2010)'},
  {id:8,cn:'å‚æœ¬é¾™é©¬',jp:'å‚æœ¬é¾é¦¬',b:1836,d:1867,faction:'å€’å¹•æ´¾/å¿—å£«',role:'ç»´æ–°å¿—å£«ï¼Œæµ·æ´é˜Ÿé˜Ÿé•¿',event:'è–©é•·åŒç›Ÿã€èˆ¹ä¸­å…«ç­–ã€å¤§æ”¿å¥‰è¿˜ã€è¿‘æ±Ÿå±‹é‡åˆº',related:'ä¸­å†ˆæ…å¤ªéƒã€èƒœæµ·èˆŸ(å¸ˆ)ã€è¥¿ä¹¡éš†ç››ã€æœ¨æˆ·å­å…',drama:'é¾é¦¬ä¼ (2010)'},
  {id:9,cn:'ä¸­å†ˆæ…å¤ªéƒ',jp:'ä¸­å²¡æ…å¤ªéƒ',b:1838,d:1867,faction:'å€’å¹•æ´¾/å¿—å£«',role:'é™†æ´é˜Ÿé˜Ÿé•¿',event:'è–©é•·åŒç›Ÿæ–¡æ—‹ã€è¿‘æ±Ÿå±‹åŒå¤œé‡åˆº',related:'å‚æœ¬é¾™é©¬(åŒå¿—)ã€è¥¿ä¹¡éš†ç››',drama:'é¾é¦¬ä¼ (2010)'},
  {id:10,cn:'å²›æ´¥é½å½¬',jp:'å³¶æ´¥æ–‰å½¬',b:1809,d:1858,faction:'è¨æ‘©è—©',role:'è¨æ‘©è—©ç¬¬28ä»£è—©ä¸»',event:'é›†æˆé¦†äº‹ä¸š(è¿‘ä»£åŒ–)ã€å°†ä¸€æ¡¥åº†å–œæ‹¥ç«‹',related:'å²›æ´¥ä¹…å…‰(å¼‚æ¯å¼Ÿ)ã€è¥¿ä¹¡éš†ç››(å®¶è‡£)ã€å¤©ç’‹é™¢(å…»å¥³)',drama:'ç¯¤å§« (2008)ã€è¥¿éƒ·ã©ã‚“ (2018)'},
  {id:11,cn:'å²›æ´¥ä¹…å…‰',jp:'å³¶æ´¥ä¹…å…‰',b:1817,d:1887,faction:'è¨æ‘©è—©',role:'è¨æ‘©è—©å›½çˆ¶(å®æƒè€…)',event:'ç‡å…µä¸Šäº¬ã€æ–‡ä¹…æ”¹é©ã€ç”Ÿéº¦äº‹ä»¶',related:'å²›æ´¥é½å½¬(å¼‚æ¯å…„)ã€è¥¿ä¹¡éš†ç››ã€å¤§ä¹…ä¿åˆ©é€š',drama:'è¥¿éƒ·ã©ã‚“ (2018)'},
  {id:12,cn:'æ¯›åˆ©æ•¬äº²',jp:'æ¯›åˆ©æ•¬è¦ª',b:1819,d:1871,faction:'é•¿å·è—©',role:'é•¿å·è—©ç¬¬13ä»£è—©ä¸»',event:'æ”¯æŒå°Šæ”˜è¿åŠ¨ã€é•¿å·å¾ä¼',related:'é«˜æ‰æ™‹ä½œã€æœ¨æˆ·å­å…',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:13,cn:'æ¾å¹³å®¹ä¿',jp:'æ¾å¹³å®¹ä¿',b:1836,d:1893,faction:'å¹•åºœæ–¹',role:'ä¼šæ´¥è—©ä¸»ï¼Œäº¬éƒ½å®ˆæŠ¤èŒ',event:'äº¬éƒ½å®ˆæŠ¤èŒã€ï¿½çš„å±‹åŸä¹‹æˆ˜ã€ä¼šæ´¥æˆ˜äº‰',related:'å¾·å·åº†å–œ(ä¸»å›)ã€è¿‘è—¤å‹‡(æ–°é€‰ç»„)',drama:'å…«é‡ã®æ¡œ (2013)'},
  {id:14,cn:'äº•ä¼Šç›´å¼¼',jp:'äº•ä¼Šç›´å¼¼',b:1815,d:1860,faction:'å¹•åºœæ–¹',role:'å¤§è€(å¹•åºœæœ€é«˜èŒ)',event:'å®‰æ”¿å¤§ç‹±ã€æ¨±ç”°é—¨å¤–ä¹‹å˜è¢«æš—æ€',related:'å¾·å·é½æ˜­(æ”¿æ•Œ)',drama:'èŠ±ã®ç”Ÿæ¶¯ (1963)'},
  {id:15,cn:'å¾·å·åº†å–œ',jp:'å¾³å·æ…¶å–œ',b:1837,d:1913,faction:'å¹•åºœæ–¹',role:'ç¬¬15ä»£(æœ«ä»£)å¾å¤·å¤§å°†å†›',event:'å¤§æ”¿å¥‰è¿˜ã€é¸Ÿç¾½ä¼è§ä¹‹æˆ˜ã€æ±Ÿæˆ·æ— è¡€å¼€åŸ',related:'å¾·å·é½æ˜­(çˆ¶)ã€æ¾å¹³å®¹ä¿ã€èƒœæµ·èˆŸ',drama:'å¾³å·æ…¶å–œ (1998)ã€é’å¤©ã‚’è¡ã‘ (2021)'},
  {id:16,cn:'èƒœæµ·èˆŸ',jp:'å‹æµ·èˆŸ',b:1823,d:1899,faction:'å¹•åºœæ–¹',role:'å¹•è‡£ï¼Œæµ·å†›å¥‰è¡Œ',event:'å’¸ä¸´ä¸¸æ¸¡ç¾ã€ç¥æˆ·æµ·å†›æ“ç»ƒæ‰€ã€æ±Ÿæˆ·æ— è¡€å¼€åŸ',related:'å‚æœ¬é¾™é©¬(å¼Ÿå­)ã€è¥¿ä¹¡éš†ç››(è°ˆåˆ¤å¯¹æ‰‹)',drama:'å‹æµ·èˆŸ (1974)'},
  {id:17,cn:'è¿‘è—¤å‹‡/åœŸæ–¹å²ä¸‰',jp:'è¿‘è—¤å‹‡/åœŸæ–¹æ­³ä¸‰',b:1834,d:1869,faction:'å¹•åºœæ–¹',role:'æ–°é€‰ç»„å±€é•¿/å‰¯é•¿',event:'æ± ç”°å±‹äº‹ä»¶ã€é¸Ÿç¾½ä¼è§ã€å‡½é¦†æˆ˜äº‰',related:'æ¾å¹³å®¹ä¿(ä¸Šå¸)ã€è¥¿ä¹¡éš†ç››(æ•Œ)',drama:'æ–°é¸çµ„! (2004)'},
  {id:18,cn:'è¥¿ä¹¡éš†ç››',jp:'è¥¿éƒ·éš†ç››',b:1828,d:1877,faction:'è¨æ‘©è—©',role:'ç»´æ–°ä¸‰æ°ï¼Œé™†å†›å¤§å°†',event:'è–©é•·åŒç›Ÿã€æˆŠè¾°æˆ˜äº‰ã€å¾éŸ©è®ºã€è¥¿å—æˆ˜äº‰',related:'å¤§ä¹…ä¿åˆ©é€š(ç›Ÿå‹â†’æ•Œ)ã€æœ¨æˆ·å­å…ã€å²›æ´¥é½å½¬',drama:'è¥¿éƒ·ã©ã‚“ (2018)ã€ç¿”ã¶ãŒå¦‚ã (1990)'},
  {id:19,cn:'å¤§ä¹…ä¿åˆ©é€š',jp:'å¤§ä¹…ä¿åˆ©é€š',b:1830,d:1878,faction:'è¨æ‘©è—©',role:'ç»´æ–°ä¸‰æ°ï¼Œå†…åŠ¡å¿',event:'ç‰ˆç±å¥‰è¿˜ã€åºŸè—©ç½®å¿ã€å¾éŸ©è®ºåå¯¹ã€çºªå°¾äº•å‚é‡åˆº',related:'è¥¿ä¹¡éš†ç››(åŒä¹¡â†’å†³è£‚)ã€å²›æ´¥ä¹…å…‰',drama:'ç¿”ã¶ãŒå¦‚ã (1990)'},
  {id:20,cn:'æœ¨æˆ·å­å…',jp:'æœ¨æˆ¸å­å…',b:1833,d:1877,faction:'é•¿å·è—©',role:'ç»´æ–°ä¸‰æ°(æ¡‚å°äº”éƒ)',event:'è–©é•·åŒç›Ÿã€äº”æ¡å¾¡èª“æ–‡ã€åºŸè—©ç½®å¿',related:'è¥¿ä¹¡éš†ç››ã€å¤§ä¹…ä¿åˆ©é€šã€å‚æœ¬é¾™é©¬',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:21,cn:'å¤§æ‘ç›Šæ¬¡éƒ',jp:'å¤§æ‘ç›Šæ¬¡éƒ',b:1824,d:1869,faction:'é•¿å·è—©',role:'å…µå­¦è€…ï¼Œè¿‘ä»£å†›åˆ¶ä¹‹çˆ¶',event:'æˆŠè¾°æˆ˜äº‰æŒ‡æŒ¥ã€é™†å†›åˆ›è®¾',related:'æœ¨æˆ·å­å…',drama:'èŠ±ç¥ (1977)'},
  {id:22,cn:'ä¼Šè—¤åšæ–‡',jp:'ä¼Šè—¤åšæ–‡',b:1841,d:1909,faction:'æ˜æ²»æ”¿åºœ',role:'ç¬¬ä¸€ä»»å†…é˜æ€»ç†å¤§è‡£',event:'å¤§æ—¥æœ¬å¸å›½å®ªæ³•åˆ¶å®šã€æ—¥æ¸…æˆ˜äº‰',related:'å‰ç”°æ¾é˜´(å¸ˆ)ã€å±±å¿æœ‰æœ‹(åŒé—¨)ã€å¤§éšˆé‡ä¿¡',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:23,cn:'å±±å¿æœ‰æœ‹',jp:'å±±ç¸£æœ‰æœ‹',b:1838,d:1922,faction:'æ˜æ²»æ”¿åºœ',role:'å…ƒå¸…ï¼Œå†›é˜€ä¹‹ç¥–',event:'å¾å…µä»¤ã€å†›äººæ••è°•ã€æ—¥ä¿„æˆ˜äº‰',related:'å‰ç”°æ¾é˜´(å¸ˆ)ã€ä¼Šè—¤åšæ–‡(åŒé—¨)',drama:'èŠ±ç‡ƒã‚† (2015)'},
  {id:24,cn:'å¤§éšˆé‡ä¿¡',jp:'å¤§éšˆé‡ä¿¡',b:1838,d:1922,faction:'æ˜æ²»æ”¿åºœ',role:'ä¸¤ä»»é¦–ç›¸ï¼Œæ—©ç¨»ç”°å¤§å­¦åˆ›å»ºè€…',event:'æ˜æ²»åå››å¹´æ”¿å˜ã€ç«‹å®ªæ”¹è¿›å…š',related:'ä¼Šè—¤åšæ–‡ã€æ¿å£é€€åŠ©',drama:'â€”'},
  {id:25,cn:'æ¿å£é€€åŠ©',jp:'æ¿å£é€€åŠ©',b:1837,d:1919,faction:'æ˜æ²»æ”¿åºœ',role:'è‡ªç”±æ°‘æƒè¿åŠ¨ä¹‹çˆ¶',event:'ï¿½çš„å‘è‡ªç”±å…šã€"æ¿å£æ­»ã™ã¨ã‚‚è‡ªç”±ã¯æ­»ã›ãš"',related:'è¥¿ä¹¡éš†ç››ã€å¤§éšˆé‡ä¿¡',drama:'â€”'},
  {id:26,cn:'é™†å¥¥å®—å…‰',jp:'é™¸å¥¥å®—å…‰',b:1844,d:1897,faction:'æ˜æ²»æ”¿åºœ',role:'å¤–åŠ¡å¤§è‡£',event:'åºŸé™¤ä¸å¹³ç­‰æ¡çº¦ã€æ—¥æ¸…æˆ˜äº‰å¤–äº¤',related:'å‚æœ¬é¾™é©¬(æµ·æ´é˜ŸåŒå¿—)ã€ä¼Šè—¤åšæ–‡',drama:'â€”'},
  {id:27,cn:'æ±Ÿè—¤æ–°å¹³',jp:'æ±Ÿè—¤æ–°å¹³',b:1834,d:1874,faction:'æ˜æ²»æ”¿åºœ',role:'å¸æ³•å¿',event:'å¸æ³•åˆ¶åº¦æ•´å¤‡ã€ä½è´ºä¹‹ä¹±ã€å¤„åˆ‘',related:'å¤§ä¹…ä¿åˆ©é€š(å¯¹ç«‹)',drama:'â€”'},
  {id:28,cn:'ç¦æ³½è°•å‰',jp:'ç¦æ¾¤è«­å‰',b:1835,d:1901,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'å¯è’™æ€æƒ³å®¶ï¼Œåº†åº”ä¹‰å¡¾åˆ›å»ºè€…',event:'ã€ŠåŠå­¦ç¯‡ã€‹ã€Šæ–‡æ˜è®ºä¹‹æ¦‚ç•¥ã€‹è„±äºšè®º',related:'â€”',drama:'â€”'},
  {id:29,cn:'ä¸­æ±Ÿå…†æ°‘',jp:'ä¸­æ±Ÿå…†æ°‘',b:1847,d:1901,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'æ€æƒ³å®¶ï¼Œ"ä¸œæ´‹å¢æ¢­"',event:'ç¿»è¯‘å¢æ¢­ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹ã€è‡ªç”±æ°‘æƒè¿åŠ¨',related:'æ¿å£é€€åŠ©',drama:'â€”'},
  {id:30,cn:'æ¶©æ³½è£ä¸€',jp:'æ¸‹æ²¢æ „ä¸€',b:1840,d:1931,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'å®ä¸šå®¶ï¼Œæ—¥æœ¬èµ„æœ¬ä¸»ä¹‰ä¹‹çˆ¶',event:'ç¬¬ä¸€å›½ç«‹é“¶è¡Œã€è®¾ç«‹500ä½™ä¼ä¸š',related:'å¾·å·åº†å–œ(æ—§ä¸»)',drama:'é’å¤©ã‚’è¡ã‘ (2021)'},
  {id:31,cn:'å²©å´å¼¥å¤ªéƒ',jp:'å²©å´å¼¥å¤ªéƒ',b:1835,d:1885,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'ä¸‰è±è´¢é˜€åˆ›å§‹äºº',event:'åˆ›ç«‹ä¸‰è±å•†ä¼š',related:'å‚æœ¬é¾™é©¬(æµ·æ´é˜Ÿ)ã€åè—¤è±¡äºŒéƒ',drama:'é¾é¦¬ä¼ (2010)'},
  {id:32,cn:'ä¸œä¹¡å¹³å…«éƒ',jp:'æ±éƒ·å¹³å…«éƒ',b:1848,d:1934,faction:'å†›äº‹',role:'å…ƒå¸…æµ·å†›å¤§å°†',event:'æ—¥ä¿„æˆ˜äº‰Â·æ—¥æœ¬æµ·æµ·æˆ˜å¤§èƒœ',related:'è¥¿ä¹¡éš†ç››(è¨æ‘©å‰è¾ˆ)',drama:'å‚ã®ä¸Šã®é›² (2009)'},
  {id:33,cn:'ä¹ƒæœ¨å¸Œå…¸',jp:'ä¹ƒæœ¨å¸Œå…¸',b:1849,d:1912,faction:'å†›äº‹',role:'é™†å†›å¤§å°†ï¼Œå†›ç¥',event:'æ—¥ä¿„æˆ˜äº‰Â·æ—…é¡ºæ”»å›´æˆ˜ã€æ˜æ²»å¤©çš‡é©¾å´©åæ®‰æ­»',related:'ä¸œä¹¡å¹³å…«éƒ',drama:'å‚ã®ä¸Šã®é›² (2009)'},
  {id:34,cn:'æ–°æ¸¡æˆ·ç¨»é€ ',jp:'æ–°æ¸¡æˆ¸ç¨²é€ ',b:1862,d:1933,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'æ•™è‚²å®¶ï¼Œå›½é™…è”ç›Ÿäº‹åŠ¡å±€æ¬¡é•¿',event:'è‹±æ–‡è‘—ä½œã€Šæ­¦å£«é“ã€‹',related:'â€”',drama:'â€”'},
  {id:35,cn:'å¤ç›®æ¼±çŸ³',jp:'å¤ç›®æ¼±çŸ³',b:1867,d:1916,faction:'æ€æƒ³å®¶/æ–‡åŒ–',role:'å°è¯´å®¶ï¼Œå›½æ°‘ä½œå®¶',event:'ã€Šæˆ‘æ˜¯çŒ«ã€‹ã€Šå¿ƒã€‹ã€Šå°‘çˆ·ã€‹',related:'â€”',drama:'â€”'},
  {id:36,cn:'å¤©ç’‹é™¢/ç¯¤å§«',jp:'å¤©ç’‹é™¢/ç¯¤å§«',b:1836,d:1883,faction:'å¥³æ€§',role:'å¾·å·å®¶å®šæ­£å®¤(å°†å†›å¾¡å°æ‰€)',event:'ä»è¨æ‘©å«å…¥å¾·å·å®¶ã€å¤§å¥¥ã€æ— è¡€å¼€åŸæ–¡æ—‹',related:'å²›æ´¥é½å½¬(å…»çˆ¶)ã€å¾·å·åº†å–œã€è¥¿ä¹¡éš†ç››',drama:'ç¯¤å§« (2008)'},
  {id:37,cn:'æ–°å²›å…«é‡',jp:'æ–°å³¶å…«é‡',b:1845,d:1932,faction:'å¥³æ€§',role:'ä¼šæ´¥å¥³æˆ˜å£«ï¼Œæ•™è‚²å®¶',event:'ä¼šæ´¥æˆ˜äº‰ä¸­æŒæªå‚æˆ˜ã€æ—¥æœ¬çº¢åå­—æ´»åŠ¨',related:'æ¾å¹³å®¹ä¿(è—©ä¸»)ã€æ–°å²›è¥„(å¤«)',drama:'å…«é‡ã®æ¡œ (2013)'},
  {id:38,cn:'æ´¥ç”°æ¢…å­',jp:'æ´¥ç”°æ¢…å­',b:1864,d:1929,faction:'å¥³æ€§',role:'å¥³å­æ•™è‚²å…ˆé©±',event:'6å²èµ´ç¾ç•™å­¦ã€åˆ›åŠæ´¥ç”°å¡¾å¤§å­¦',related:'â€”',drama:'â€”'},
  {id:39,cn:'ä¸è°¢é‡æ™¶å­',jp:'ä¸è¬é‡æ™¶å­',b:1878,d:1942,faction:'å¥³æ€§',role:'æ­Œäººï¼Œåæˆ˜è¯—äºº',event:'ã€Šå›æ­»ã«ãŸã¾ãµã“ã¨ãªã‹ã‚Œã€‹åæˆ˜è¯—',related:'â€”',drama:'â€”'}
];

// Table
function renderTable(){
  const tbody=document.getElementById('tableBody');
  tbody.innerHTML=DATA.map(d=>`<tr data-faction="${d.faction}">
    <td>${d.id}</td><td><strong>${d.cn}</strong></td><td>${d.jp}</td>
    <td>${d.b}-${d.d}</td>
    <td><span class="faction-tag" style="background:${FCOLORS[d.faction]}">${d.faction}</span></td>
    <td>${d.role}</td><td>${d.event}</td><td>${d.related}</td><td>${d.drama}</td>
  </tr>`).join('');
}

let sortCol=-1, sortAsc=true;
function sortTable(col){
  if(sortCol===col) sortAsc=!sortAsc; else { sortCol=col; sortAsc=true; }
  const rows=[...document.querySelectorAll('#tableBody tr')];
  rows.sort((a,b)=>{
    let va=a.cells[col].textContent, vb=b.cells[col].textContent;
    if(col===0||col===3){ va=parseInt(va)||0; vb=parseInt(vb)||0; return sortAsc?va-vb:vb-va; }
    return sortAsc?va.localeCompare(vb,'zh'):vb.localeCompare(va,'zh');
  });
  const tbody=document.getElementById('tableBody');
  rows.forEach(r=>tbody.appendChild(r));
}

function filterTable(){
  const q=document.getElementById('searchBox').value.toLowerCase();
  const f=document.getElementById('factionFilter').value;
  document.querySelectorAll('#tableBody tr').forEach(r=>{
    const text=r.textContent.toLowerCase();
    const faction=r.dataset.faction;
    r.style.display=(text.includes(q)&&(!f||faction===f))?'':'none';
  });
}

// Timeline
function renderTimeline(){
  const c=document.getElementById('timeline-container');
  const W=1400, H=820, pad=50, labelW=100;
  const minY=1795, maxY=1945;
  const x=v=>labelW+(v-minY)/(maxY-minY)*(W-labelW-pad);
  // sort by birth
  const sorted=[...DATA].sort((a,b)=>a.b-b.b);
  const rowH=Math.min(20, (H-60)/sorted.length);
  let svg=`<svg class="timeline-svg" viewBox="0 0 ${W} ${Math.max(H, sorted.length*rowH+60)}" xmlns="http://www.w3.org/2000/svg" style="width:100%;font-family:sans-serif">`;
  // grid
  for(let y=1800;y<=1940;y+=10){
    const xp=x(y);
    svg+=`<line x1="${xp}" y1="25" x2="${xp}" y2="${sorted.length*rowH+40}" stroke="var(--border)" stroke-width="0.5"/>`;
    svg+=`<text x="${xp}" y="18" text-anchor="middle" fill="var(--text2)" font-size="11">${y}</text>`;
  }
  sorted.forEach((d,i)=>{
    const yp=35+i*rowH;
    const clr=FCOLORS[d.faction];
    svg+=`<text x="${labelW-5}" y="${yp+rowH/2+4}" text-anchor="end" fill="var(--text)" font-size="10">${d.cn}</text>`;
    svg+=`<rect x="${x(d.b)}" y="${yp}" width="${x(d.d)-x(d.b)}" height="${rowH-3}" rx="3" fill="${clr}" opacity="0.75"><title>${d.cn} (${d.b}-${d.d})</title></rect>`;
  });
  svg+=`</svg>`;
  c.innerHTML=svg;
}

// Network graph
function renderNetwork(){
  const nodes=DATA.map(d=>({
    id:d.id, label:d.cn, group:d.faction,
    title:`${d.cn} (${d.jp})\n${d.b}-${d.d}\n${d.role}`,
    color:{background:FCOLORS[d.faction],border:FCOLORS[d.faction],highlight:{background:FCOLORS[d.faction],border:'#000'}},
    font:{color:'#fff',size:12,strokeWidth:2,strokeColor:FCOLORS[d.faction]}
  }));

  const EDGE_STYLES={
    'å¸ˆå¾’':{color:'#e65100',dashes:false,label:'å¸ˆå¾’'},
    'åŒå¿—':{color:'#2e7d32',dashes:false,label:'åŒå¿—'},
    'æ•Œå¯¹':{color:'#c62828',dashes:[5,5],label:'æ•Œå¯¹'},
    'çˆ¶å­':{color:'#1565c0',dashes:false,label:'çˆ¶å­'},
    'å…„å¼Ÿ':{color:'#1565c0',dashes:[8,4],label:'å…„å¼Ÿ'},
    'å›è‡£':{color:'#6a1b9a',dashes:false,label:'å›è‡£'},
    'åŒç›Ÿ':{color:'#00796b',dashes:false,label:'åŒç›Ÿ'},
    'å…»å¥³':{color:'#c2185b',dashes:false,label:'å…»å¥³'},
    'å«å…¥':{color:'#c2185b',dashes:[5,5],label:'å«å…¥'},
    'ææ‹”':{color:'#ef6c00',dashes:[3,3],label:'ææ‹”'},
    'è°ˆåˆ¤':{color:'#546e7a',dashes:[8,4],label:'è°ˆåˆ¤'},
    'å¥³å©¿':{color:'#c2185b',dashes:[3,3],label:'å¥³å©¿'},
    'åŒé—¨':{color:'#e65100',dashes:[3,3],label:'åŒé—¨'},
  };

  const edgesData=[
    {from:2,to:5,t:'å¸ˆå¾’'},{from:2,to:6,t:'å¸ˆå¾’'},{from:2,to:22,t:'å¸ˆå¾’'},{from:2,to:23,t:'å¸ˆå¾’'},
    {from:6,to:2,t:'å¥³å©¿'},
    {from:8,to:9,t:'åŒå¿—'},{from:8,to:16,t:'å¸ˆå¾’'},
    {from:8,to:18,t:'åŒç›Ÿ',label:'è–©é•·åŒç›Ÿ'},{from:8,to:20,t:'åŒç›Ÿ',label:'è–©é•·åŒç›Ÿ'},
    {from:18,to:19,t:'åŒå¿—',label:'åŒä¹¡â†’å†³è£‚'},{from:18,to:20,t:'åŒç›Ÿ'},
    {from:10,to:11,t:'å…„å¼Ÿ'},{from:10,to:18,t:'ææ‹”'},{from:10,to:36,t:'å…»å¥³'},
    {from:1,to:15,t:'çˆ¶å­'},{from:15,to:13,t:'å›è‡£'},
    {from:14,to:1,t:'æ•Œå¯¹'},{from:18,to:19,t:'æ•Œå¯¹',label:'è¥¿å—æˆ˜äº‰'},
    {from:36,to:15,t:'å«å…¥'},
    {from:16,to:18,t:'è°ˆåˆ¤',label:'æ±Ÿæˆ·æ— è¡€å¼€åŸ'},
    {from:3,to:2,t:'å¸ˆå¾’'},{from:3,to:16,t:'å¸ˆå¾’'},
    {from:5,to:6,t:'åŒé—¨'},
    {from:7,to:8,t:'åŒå¿—',label:'åœŸä½åŒä¹¡'},
    {from:37,to:13,t:'å›è‡£',label:'ä¼šæ´¥'},
    {from:30,to:15,t:'å›è‡£',label:'æ—§ä¸»'},
    {from:32,to:18,t:'åŒå¿—',label:'è¨æ‘©'},
  ];

  // deduplicate edges between same pair: keep first
  const seen=new Set();
  const edges=[];
  edgesData.forEach(e=>{
    const key=Math.min(e.from,e.to)+'-'+Math.max(e.from,e.to)+'-'+e.t;
    if(!seen.has(key)){seen.add(key);
      const s=EDGE_STYLES[e.t]||{color:'#999',dashes:false};
      edges.push({from:e.from,to:e.to,
        label:e.label||s.label,
        color:{color:s.color,highlight:s.color},
        dashes:s.dashes,
        font:{size:9,color:s.color,strokeWidth:0},
        arrows:e.t==='å¸ˆå¾’'||e.t==='çˆ¶å­'||e.t==='ææ‹”'||e.t==='å…»å¥³'?'to':'',
        smooth:{type:'continuous'}
      });
    }
  });

  const container=document.getElementById('network');
  new vis.Network(container,{nodes:new vis.DataSet(nodes),edges:new vis.DataSet(edges)},{
    physics:{barnesHut:{gravitationalConstant:-4000,springLength:180,springConstant:0.02},stabilization:{iterations:200}},
    interaction:{hover:true,tooltipDelay:100},
    layout:{improvedLayout:true}
  });

  // legends
  document.getElementById('nodeLegend').innerHTML=Object.entries(FCOLORS).map(([k,v])=>
    `<span class="legend-item"><span class="legend-dot" style="background:${v}"></span>${k}</span>`).join('');
  const edgeTypes=['å¸ˆå¾’','åŒå¿—','æ•Œå¯¹','çˆ¶å­','å…„å¼Ÿ','å›è‡£','åŒç›Ÿ','å…»å¥³','å«å…¥','ææ‹”','è°ˆåˆ¤'];
  document.getElementById('edgeLegend').innerHTML=edgeTypes.map(t=>{
    const s=EDGE_STYLES[t];
    const dash=s.dashes?'stroke-dasharray:'+s.dashes.join(','):'';
    return `<span><svg width="24" height="6"><line x1="0" y1="3" x2="24" y2="3" stroke="${s.color}" stroke-width="2" style="${dash}"/></svg>${t}</span>`;
  }).join('');
}

function showSection(id,btn){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById('sec-'+id).classList.add('active');
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  if(id==='graph') renderNetwork();
}

function toggleTheme(){
  const d=document.documentElement;
  const dark=d.getAttribute('data-theme')==='dark';
  d.setAttribute('data-theme',dark?'':'dark');
  document.querySelector('.theme-toggle').textContent=dark?'ğŸŒ™':'â˜€ï¸';
}

renderTable();
renderTimeline();
</script>
</body>
</html>